# LG-CLIP ğŸ“š
**Can Synthetic Images Serve as Effective and Efficient Class Prototypes?** ğŸ¨ğŸ¤–

**ğŸ‰ Our paper is accepted by IEEE ICASSP 2026 ğŸ‰**

Our preprint paper:  https://arxiv.org/abs/2512.17160
## Overview ğŸ”
This project explores the generalization capabilities of Vision-Language Models (VLMs) through the lens of image generation. Below are the key scripts and their functionalities:

### Scripts ğŸ’»
- **`vanilla_clip.py`**: Get visual features of real images via VFE(Â·) ğŸ”‘
- **`vanilla_clip_ms.py`**: Get multi-scale visual features of real images ğŸŒ
- **`prompts_gen.py`**: Generate prompts used to generate images via LLM ğŸ“
- **`sd_gen.py`**: Generate images through Stable Diffusion's `text2image` block ğŸ–¼ï¸
- **`gen_feat.py`**: Get visual features of generated images via VFE(Â·) ğŸ§ 
- **`multi_scale_gen_feat.py`**: Get multi-scale features of generated images ğŸ§³
- **`mega.py`**: Contrast real features and generated features, and predict prototypes of real images ğŸ”®

## Dataset ğŸ“¦

The project works with the following datasets:

- **CUB** ğŸ¦…
- **EUROSAT** ğŸŒ
- **FLO** ğŸŒ¾
- **FOOD** ğŸ”
- **ImageNet** ğŸ–¼ï¸
- **PET** ğŸ¶
- **SD_gen** ğŸï¸: Directory containing datasets used for generating images through Stable Diffusion.
- **LLM_SD_gen** ğŸ–¥ï¸: Directory containing prompts generated by a large language model (LLM), used as input for Stable Diffusion to generate images.
- **prompts** âœï¸: Folder holding various prompts for generating images, stored in text files.

## Directory Tree ğŸŒ³

Here's an overview of the project structure:

```plaintext
LG_CLIP/
â”‚
â”œâ”€â”€ vanilla_clip.py               # Get visual features of real images via VFE(Â·)
â”œâ”€â”€ vanilla_clip_ms.py            # Get multi-scale visual features of real images
â”œâ”€â”€ prompts_gen.py                # Generate prompts used to generate images via LLM
â”œâ”€â”€ sd_gen.py                     # Generate images through Stable Diffusion's text2image block
â”œâ”€â”€ gen_feat.py                   # Get visual features of generated images via VFE(Â·)
â”œâ”€â”€ multi_scale_gen_feat.py       # Get multi-scale features of generated images
â”œâ”€â”€ mega.py                       # Contrast real features and generated features, and predict prototypes of real images
â”‚
â””â”€â”€ dataset/
    â”œâ”€â”€ CUB                       # CUB dataset
    â”œâ”€â”€ EUROSAT                   # EUROSAT dataset
    â”œâ”€â”€ FLO                       # FLO dataset
    â”œâ”€â”€ FOOD                      # FOOD dataset
    â”œâ”€â”€ ImageNet                  # ImageNet dataset
    â”œâ”€â”€ PET                       # PET dataset
    â”œâ”€â”€ SD_gen                    # Dataset folder for images generated using Stable Diffusion
    â”œâ”€â”€ LLM_SD_gen                # Dataset folder for images generated using Stable Diffusion and LLM-generated prompts
    â””â”€â”€ prompts                   # Folder storing prompts in text files for image generation
